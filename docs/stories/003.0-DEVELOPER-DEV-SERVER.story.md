# 003.0-DEVELOPER-DEV-SERVER: Start Development Server with Hot Reload

## Release Goal

**Production-Ready Foundation** - Enable developers to get from zero to working API server in under 30 seconds with a single npm init command.

This story completes the "Verify Setup" journey phase by ensuring the development server starts successfully with automatic reload capabilities. After dependencies are installed (002.0), developers need to immediately verify the server runs and can begin active development with fast feedback loops.

## How This Story Contributes

This story is a critical verification point that confirms the template is working correctly and enables active development. It enables:

- **Fast Feedback Loop**: Automatic restart on code changes allows rapid iteration without manual server restarts
- **Immediate Productivity**: Developer can start writing business logic immediately after confirming server starts
- **Quality Foundation**: Working dev server unblocks stories 005.0 (security headers verification), 008.0 (log monitoring), and 009.0 (route examples)
- **Confidence Building**: Successful server start confirms setup is correct and template is production-ready

## User Story

**Format**: So that I can immediately start developing with fast feedback on my changes, as an API Developer, I want the development server to start successfully and automatically restart when I modify code.

**INVEST Criteria Compliance**:

- **Independent**: Depends only on 002.0 (dependencies installed); can be developed in parallel with 004.0, 006.0, 007.0
- **Negotiable**: Specific watch patterns and restart behavior can be refined based on developer feedback
- **Valuable**: Enables active development - developer can modify code and see results immediately without manual restarts
- **Estimable**: Clear scope - run npm run dev, verify server starts, confirm automatic restart on file changes
- **Small**: Single iteration - focused on dev server start and hot reload only
- **Testable**: Clear success criteria - server starts, responds to requests, restarts automatically on code changes

## Acceptance Criteria

- [x] **Server Starts Successfully**: Running `npm run dev` starts the development server without errors
- [x] **Server Starts Without Pre-Built Dist**: Running `npm run dev` immediately after `npm install` (without running `npm run build` first) successfully compiles TypeScript and starts the server
- [x] **Port Auto-Discovery**: Server starts on default port (3000) or automatically finds next available port if 3000 is in use
- [x] **Strict Port Mode**: When PORT environment variable is set, server fails with clear error if that specific port is unavailable
- [x] **Health Check Accessible**: Server responds to GET /health with 200 OK status
- [x] **Automatic Restart**: Changing TypeScript source files automatically triggers server restart
- [x] **Fast Restart Time**: Server restarts in under 2 seconds after file changes
- [x] **Clear Console Output**: Server logs show clear startup messages including listening URL and port (especially important when auto-discovering port)
- [x] **Error Messages**: TypeScript compilation errors are displayed clearly in console with file/line references
- [x] **Graceful Shutdown**: Ctrl+C cleanly stops the development server without hanging or errors

## Requirements

- **REQ-DEV-START-FAST**: Development server starts in under 5 seconds on initial launch
- **REQ-DEV-INITIAL-COMPILE**: Development server waits for initial TypeScript compilation to complete before attempting to start the server, preventing "file not found" errors when starting from a fresh project
- **REQ-DEV-HOT-RELOAD**: File changes trigger automatic server restart without manual intervention
- **REQ-DEV-TYPESCRIPT-WATCH**: TypeScript compilation errors shown immediately in console during development
- **REQ-DEV-PORT-AUTO**: Server automatically finds available port when default port is in use
- **REQ-DEV-PORT-STRICT**: When PORT environment variable is explicitly set, server fails with clear error if port unavailable
- **REQ-DEV-CLEAN-LOGS**: Startup logs clearly show listening address and actual port used (critical for auto-discovery mode)
- **REQ-DEV-ERROR-DISPLAY**: Compilation and runtime errors display with helpful context and suggestions
- **REQ-DEV-GRACEFUL-STOP**: Server shuts down cleanly on SIGINT/SIGTERM signals

## Dependencies

- **002.0-DEVELOPER-DEPENDENCIES-INSTALL**: Development server requires all dependencies installed and git hooks configured

## Implementation Notes

**Developer Context**:

- This story focuses on the development experience - server must start quickly and provide clear feedback
- The `npm run dev` command should handle TypeScript compilation and watching automatically
- Developer should see immediate feedback when they save a file - both for successful changes and errors
- After this story completes, developer can begin adding custom routes and business logic

**Integration Points**:

- Enables 005.0-DEVELOPER-SECURITY-HEADERS (requires running server to verify headers)
- Enables 008.0-DEVELOPER-LOGS-MONITOR (requires running server to observe structured logs)
- Enables 009.0-DEVELOPER-ROUTE-EXAMPLE (developer needs working dev server to test custom routes)

## Definition of Done

- [x] npm run dev starts server successfully in initialized project (when dist/ folder exists)
- [x] npm run dev starts server successfully without pre-built dist/ folder (initial compilation scenario)
- [x] All acceptance criteria met
- [x] Server automatically restarts on TypeScript file changes
- [x] Clear console output with listening URL and port
- [x] Error messages are helpful and actionable
- [x] Documentation reflects the dev server workflow
- [x] Test coverage includes initial compilation scenario without DEV_SERVER_SKIP_TSC_WATCH

---

## Story Metadata

- **Story Number**: 003.0
- **Persona**: Developer (API Developer)
- **Theme**: Production-Ready Foundation â†’ Working Server
- **Journey Phase**: Verify Setup
- **Estimated Effort**: Medium
- **Priority**: 3 (High Cost of Delay - blocks active development and subsequent verification stories)
