{
  "statistics": {
    "detectionDate": "2025-12-15T06:12:06.903Z",
    "formats": {
      "javascript": {
        "sources": {
          "scripts/lint-format-smoke.mjs": {
            "lines": 152,
            "tokens": 1243,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "scripts/copy-template-files.mjs": {
            "lines": 38,
            "tokens": 284,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "scripts/check-node-version.mjs": {
            "lines": 127,
            "tokens": 592,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/template-files/dev-server.mjs": {
            "lines": 452,
            "tokens": 2534,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/check-node-version.test.js": {
            "lines": 80,
            "tokens": 759,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          }
        },
        "total": {
          "lines": 849,
          "tokens": 5412,
          "sources": 5,
          "clones": 0,
          "duplicatedLines": 0,
          "duplicatedTokens": 0,
          "percentage": 0,
          "percentageTokens": 0,
          "newDuplicatedLines": 0,
          "newClones": 0
        }
      },
      "typescript": {
        "sources": {
          "scripts/check-node-version.d.ts": {
            "lines": 43,
            "tokens": 210,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/template-package-json.ts": {
            "lines": 62,
            "tokens": 290,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/run-command-in-project.test-helpers.ts": {
            "lines": 54,
            "tokens": 386,
            "sources": 1,
            "clones": 3,
            "duplicatedLines": 46,
            "duplicatedTokens": 361,
            "percentage": 85.19,
            "percentageTokens": 93.52,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/repo-hygiene.generated-projects.test.ts": {
            "lines": 62,
            "tokens": 376,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/npm-init.smoke.test.ts": {
            "lines": 159,
            "tokens": 1101,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/npm-init-e2e.test.ts": {
            "lines": 163,
            "tokens": 1463,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/mjs-modules.d.ts": {
            "lines": 15,
            "tokens": 31,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/initializer.ts": {
            "lines": 282,
            "tokens": 1520,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/initializer.test.ts": {
            "lines": 251,
            "tokens": 2332,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/index.ts": {
            "lines": 12,
            "tokens": 34,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/index.test.d.ts": {
            "lines": 70,
            "tokens": 291,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/generated-project.test-helpers.ts": {
            "lines": 261,
            "tokens": 2088,
            "sources": 1,
            "clones": 3,
            "duplicatedLines": 33,
            "duplicatedTokens": 312,
            "percentage": 12.64,
            "percentageTokens": 14.94,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/generated-project-tests.story-004.test.ts": {
            "lines": 101,
            "tokens": 868,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/generated-project-security-headers.test.ts": {
            "lines": 108,
            "tokens": 809,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 13,
            "duplicatedTokens": 168,
            "percentage": 12.04,
            "percentageTokens": 20.77,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/generated-project-production.test.ts": {
            "lines": 126,
            "tokens": 1025,
            "sources": 1,
            "clones": 3,
            "duplicatedLines": 33,
            "duplicatedTokens": 338,
            "percentage": 26.19,
            "percentageTokens": 32.98,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/generated-project-production-npm-start.test.ts": {
            "lines": 153,
            "tokens": 1359,
            "sources": 1,
            "clones": 4,
            "duplicatedLines": 44,
            "duplicatedTokens": 416,
            "percentage": 28.76,
            "percentageTokens": 30.61,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/generated-project-logging.test.ts": {
            "lines": 89,
            "tokens": 585,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/dev-server.test.ts": {
            "lines": 188,
            "tokens": 1789,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 16,
            "duplicatedTokens": 242,
            "percentage": 8.51,
            "percentageTokens": 13.53,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/dev-server.test-helpers.ts": {
            "lines": 193,
            "tokens": 1669,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 7,
            "duplicatedTokens": 86,
            "percentage": 3.63,
            "percentageTokens": 5.15,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/dev-server-test-types.d.ts": {
            "lines": 63,
            "tokens": 458,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 7,
            "duplicatedTokens": 86,
            "percentage": 11.11,
            "percentageTokens": 18.78,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/cli.ts": {
            "lines": 63,
            "tokens": 269,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/cli.test.ts": {
            "lines": 293,
            "tokens": 2605,
            "sources": 1,
            "clones": 3,
            "duplicatedLines": 43,
            "duplicatedTokens": 355,
            "percentage": 14.68,
            "percentageTokens": 13.63,
            "newDuplicatedLines": 0,
            "newClones": 0
          }
        },
        "total": {
          "lines": 2811,
          "tokens": 21558,
          "sources": 22,
          "clones": 11,
          "duplicatedLines": 121,
          "duplicatedTokens": 1182,
          "percentage": 4.3,
          "percentageTokens": 5.48,
          "newDuplicatedLines": 0,
          "newClones": 0
        }
      }
    },
    "total": {
      "lines": 3660,
      "tokens": 26970,
      "sources": 27,
      "clones": 11,
      "duplicatedLines": 121,
      "duplicatedTokens": 1182,
      "percentage": 3.31,
      "percentageTokens": 4.38,
      "newDuplicatedLines": 0,
      "newClones": 0
    }
  },
  "duplicates": [
    {
      "format": "typescript",
      "lines": 6,
      "fragment": ");\n      expect(health.statusCode).toBe(200);\n      expect(() => JSON.parse(health.body)).not.toThrow();\n      expect(JSON.parse(health.body)).toEqual({ status: 'ok' });\n\n      // Encode the \"No Source References\" acceptance criterion by asserting that server",
      "tokens": 0,
      "firstFile": {
        "name": "src/generated-project-production.test.ts",
        "start": 81,
        "end": 86,
        "startLoc": {
          "line": 81,
          "column": 7,
          "position": 645
        },
        "endLoc": {
          "line": 86,
          "column": 83,
          "position": 715
        }
      },
      "secondFile": {
        "name": "src/generated-project-security-headers.test.ts",
        "start": 82,
        "end": 88,
        "startLoc": {
          "line": 82,
          "column": 10,
          "position": 601
        },
        "endLoc": {
          "line": 88,
          "column": 6,
          "position": 672
        }
      }
    },
    {
      "format": "typescript",
      "lines": 15,
      "fragment": ");\n\n    try {\n      // 10 seconds is treated as an upper bound for a healthy response for the tiny template project,\n      // aligning with the \"Fast Build\" / \"Server Responds\" expectations in Story 006.0.\n      console.log(\n        '[generated-project-production] waiting for health endpoint at',\n        healthUrl.toString(),\n      );\n      const health = await waitForHealth(healthUrl, 10_000);\n      console.log('[generated-project-production] received health response', health);\n      expect(health.statusCode).toBe(200);\n      expect(() => JSON.parse(health.body)).not.toThrow();\n      expect(JSON.parse(health.body)).toEqual({ status: 'ok' });\n    }",
      "tokens": 0,
      "firstFile": {
        "name": "src/generated-project-production.test.ts",
        "start": 109,
        "end": 123,
        "startLoc": {
          "line": 109,
          "column": 5,
          "position": 862
        },
        "endLoc": {
          "line": 123,
          "column": 2,
          "position": 996
        }
      },
      "secondFile": {
        "name": "src/generated-project-production.test.ts",
        "start": 71,
        "end": 88,
        "startLoc": {
          "line": 71,
          "column": 2,
          "position": 580
        },
        "endLoc": {
          "line": 88,
          "column": 6,
          "position": 672
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "let stdout = '';\n    let stderr = '';\n\n    child.stdout?.on('data', chunk => {\n      stdout += chunk.toString();\n    });\n\n    child.stderr?.on('data', chunk => {\n      stderr += chunk.toString();\n    });\n\n    child",
      "tokens": 0,
      "firstFile": {
        "name": "src/generated-project-production-npm-start.test.ts",
        "start": 48,
        "end": 59,
        "startLoc": {
          "line": 48,
          "column": 5,
          "position": 405
        },
        "endLoc": {
          "line": 59,
          "column": 6,
          "position": 496
        }
      },
      "secondFile": {
        "name": "src/run-command-in-project.test-helpers.ts",
        "start": 37,
        "end": 48,
        "startLoc": {
          "line": 37,
          "column": 3,
          "position": 222
        },
        "endLoc": {
          "line": 48,
          "column": 6,
          "position": 313
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ");\n\n    let stdout = '';\n    child.stdout?.on('data', chunk => {\n      stdout += chunk.toString();\n    });\n\n    const healthUrl = await new Promise<URL>((resolve, reject) => {\n      const timeout = setTimeout(() => {\n        reject(\n          new Error(`Timed out waiting for server to report listening URL. stdout:\\n${stdout}`),",
      "tokens": 0,
      "firstFile": {
        "name": "src/generated-project-production-npm-start.test.ts",
        "start": 115,
        "end": 125,
        "startLoc": {
          "line": 115,
          "column": 2,
          "position": 970
        },
        "endLoc": {
          "line": 125,
          "column": 2,
          "position": 1077
        }
      },
      "secondFile": {
        "name": "src/generated-project.test-helpers.ts",
        "start": 232,
        "end": 241,
        "startLoc": {
          "line": 232,
          "column": 4,
          "position": 1792
        },
        "endLoc": {
          "line": 241,
          "column": 2,
          "position": 1897
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ");\n        if (match) {\n          clearInterval(interval);\n          globalThis.clearTimeout(timeout);\n          resolve(new URL('/health', match[1]));\n        }\n      }, 500);\n\n      child.on('exit', code => {\n        clearInterval(interval);\n        globalThis.clearTimeout(timeout);\n        reject(new Error(`Server process exited early with code ${code}. stdout:\\n${stdout}`));\n      });\n    });\n\n    try",
      "tokens": 0,
      "firstFile": {
        "name": "src/generated-project-production-npm-start.test.ts",
        "start": 130,
        "end": 145,
        "startLoc": {
          "line": 130,
          "column": 40,
          "position": 1121
        },
        "endLoc": {
          "line": 145,
          "column": 4,
          "position": 1241
        }
      },
      "secondFile": {
        "name": "src/generated-project.test-helpers.ts",
        "start": 246,
        "end": 261,
        "startLoc": {
          "line": 246,
          "column": 7,
          "position": 1953
        },
        "endLoc": {
          "line": 261,
          "column": 7,
          "position": 2073
        }
      }
    },
    {
      "format": "typescript",
      "lines": 9,
      "fragment": ");\n      expect(health.statusCode).toBe(200);\n      expect(() => JSON.parse(health.body)).not.toThrow();\n      expect(JSON.parse(health.body)).toEqual({ status: 'ok' });\n    } finally {\n      child.kill('SIGINT');\n    }\n  }, 180_000);\n});",
      "tokens": 0,
      "firstFile": {
        "name": "src/generated-project-production-npm-start.test.ts",
        "start": 146,
        "end": 154,
        "startLoc": {
          "line": 146,
          "column": 5,
          "position": 1261
        },
        "endLoc": {
          "line": 154,
          "column": 2,
          "position": 1359
        }
      },
      "secondFile": {
        "name": "src/generated-project-security-headers.test.ts",
        "start": 82,
        "end": 127,
        "startLoc": {
          "line": 82,
          "column": 10,
          "position": 601
        },
        "endLoc": {
          "line": 127,
          "column": 2,
          "position": 1025
        }
      }
    },
    {
      "format": "typescript",
      "lines": 9,
      "fragment": ");\n\n      const { code, signal } = await sendSigintAndWait(child, 10_000);\n      expect(signal === 'SIGINT' || code === 0).toBe(true);\n    } finally {\n      const { rm } = await import('node:fs/promises');\n      await rm(projectDir, { recursive: true, force: true }).catch(() => {});\n    }\n  })",
      "tokens": 0,
      "firstFile": {
        "name": "src/dev-server.test.ts",
        "start": 180,
        "end": 188,
        "startLoc": {
          "line": 180,
          "column": 5,
          "position": 1663
        },
        "endLoc": {
          "line": 188,
          "column": 2,
          "position": 1784
        }
      },
      "secondFile": {
        "name": "src/dev-server.test.ts",
        "start": 89,
        "end": 100,
        "startLoc": {
          "line": 89,
          "column": 6,
          "position": 767
        },
        "endLoc": {
          "line": 100,
          "column": 6,
          "position": 890
        }
      }
    },
    {
      "format": "typescript",
      "lines": 8,
      "fragment": "export function createDevServerProcess(\n    env: Record<string, string | undefined>,\n    options?: { cwd?: string; devServerPath?: string },\n  ): {\n    child: ChildProcess;\n    getStdout: () => string;\n    getStderr: () => string;\n  };",
      "tokens": 0,
      "firstFile": {
        "name": "src/dev-server-test-types.d.ts",
        "start": 32,
        "end": 39,
        "startLoc": {
          "line": 32,
          "column": 3,
          "position": 177
        },
        "endLoc": {
          "line": 39,
          "column": 2,
          "position": 263
        }
      },
      "secondFile": {
        "name": "src/dev-server.test-helpers.ts",
        "start": 41,
        "end": 48,
        "startLoc": {
          "line": 41,
          "column": 1,
          "position": 309
        },
        "endLoc": {
          "line": 48,
          "column": 2,
          "position": 394
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ",\n      stdio: ['ignore', 'pipe', 'pipe'],\n    });\n\n    let stdout = '';\n    let stderr = '';\n\n    child.stdout?.on('data', chunk => {\n      stdout += chunk.toString();\n    });\n\n    child.stderr?.on('data', chunk => {\n      stderr += chunk.toString();\n    });\n\n    child.on('error'",
      "tokens": 0,
      "firstFile": {
        "name": "src/cli.test.ts",
        "start": 35,
        "end": 50,
        "startLoc": {
          "line": 35,
          "column": 4,
          "position": 297
        },
        "endLoc": {
          "line": 50,
          "column": 8,
          "position": 416
        }
      },
      "secondFile": {
        "name": "src/run-command-in-project.test-helpers.ts",
        "start": 33,
        "end": 59,
        "startLoc": {
          "line": 33,
          "column": 2,
          "position": 198
        },
        "endLoc": {
          "line": 59,
          "column": 7,
          "position": 500
        }
      }
    },
    {
      "format": "typescript",
      "lines": 21,
      "fragment": ");\n\n    let stdout = '';\n    let stderr = '';\n\n    child.stdout?.on('data', chunk => {\n      stdout += chunk.toString();\n    });\n\n    child.stderr?.on('data', chunk => {\n      stderr += chunk.toString();\n    });\n\n    child.on('error', reject);\n    child.on('exit', code => {\n      resolve({ code, stdout, stderr });\n    });\n  });\n}\n\nasync",
      "tokens": 0,
      "firstFile": {
        "name": "src/cli.test.ts",
        "start": 86,
        "end": 106,
        "startLoc": {
          "line": 86,
          "column": 8,
          "position": 821
        },
        "endLoc": {
          "line": 106,
          "column": 6,
          "position": 972
        }
      },
      "secondFile": {
        "name": "src/run-command-in-project.test-helpers.ts",
        "start": 35,
        "end": 57,
        "startLoc": {
          "line": 35,
          "column": 2,
          "position": 217
        },
        "endLoc": {
          "line": 57,
          "column": 10,
          "position": 467
        }
      }
    },
    {
      "format": "typescript",
      "lines": 9,
      "fragment": ", res => {\n      let body = '';\n      res.on('data', chunk => {\n        body += chunk.toString();\n      });\n      res.on('end', () => {\n        resolve({\n          statusCode: res.statusCode ?? 0,\n          body,",
      "tokens": 0,
      "firstFile": {
        "name": "src/cli.test.ts",
        "start": 201,
        "end": 209,
        "startLoc": {
          "line": 201,
          "column": 10,
          "position": 1766
        },
        "endLoc": {
          "line": 209,
          "column": 2,
          "position": 1851
        }
      },
      "secondFile": {
        "name": "src/generated-project.test-helpers.ts",
        "start": 152,
        "end": 158,
        "startLoc": {
          "line": 152,
          "column": 4,
          "position": 1072
        },
        "endLoc": {
          "line": 158,
          "column": 2,
          "position": 1156
        }
      }
    }
  ]
}
