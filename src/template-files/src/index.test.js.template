/**
 * Example JavaScript tests for the generated Fastify server.
 *
 * This file is copied into new projects as src/index.test.js during
 * template initialization to demonstrate that plain JavaScript tests
 * are also supported alongside TypeScript tests.
 *
 * @supports docs/stories/004.0-DEVELOPER-TESTS-RUN.story.md REQ-TEST-EXAMPLES REQ-TEST-CLEAR-OUTPUT
 */
import { describe, it, expect } from 'vitest';

import { buildServer } from './index.ts';

describe('Generated Fastify server (JS example) (Story 004.0) [REQ-TEST-EXAMPLES]', () => {
  it('responds with status ok on GET /health (JS)', async () => {
    const fastify = await buildServer();

    const response = await fastify.inject({
      method: 'GET',
      url: '/health',
    });

    expect(response.statusCode).toBe(200);
    expect(response.json()).toEqual({ status: 'ok' });

    await fastify.close();
  });
});